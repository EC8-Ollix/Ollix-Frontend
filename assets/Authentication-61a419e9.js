import{d as z,r as b,u as B,a as P,U as V,A as M,b as U,S as T,s as D,n as $,c as G,_ as H,e as g,o as h,f as C,g as u,h as a,w as r,i as v,j as w,k as O,p as K,l as Q}from"./index-0bd96fdb.js";import{L as W}from"./LockOutlined-bdf14291.js";const X=z({name:"Authentication",setup(){const e=b(!0),o=B(),N=b(1),d=b(!1),_=()=>{e.value=!e.value},k=()=>{N.value=1},p=(i,s)=>s===""?Promise.reject("Por favor, insira a senha."):Promise.resolve(),m=(i,s)=>s===""?Promise.reject("Por favor, confirme a senha."):s!==t.password?Promise.reject("As senhas não coincidem."):Promise.resolve(),l=b(),f=P({userEmail:"",password:""}),S={userEmail:[{required:!0,message:"O Email é obrigatório",trigger:"blur"},{type:"email",message:"O Email está inválido",trigger:"blur"}],password:[{required:!0,validator:p,trigger:"blur"},{min:6,message:"A senha deve ter pelo menos 6 caracteres",trigger:"blur"}]},c=async()=>{var i;try{d.value=!0;const s={userEmail:f.userEmail,userPassword:f.password},L=(await U.post("auth/login",s)).data;d.value=!1,T(L),D.getters.isAdmin?await o.push("/admin"):await o.push("/")}catch(s){let n=(i=s==null?void 0:s.response)==null?void 0:i.data;d.value=!1,$(n)}},E=i=>{},R=b(),t=P({firstName:"",lastName:"",userEmail:"",password:"",confirmPassword:""}),A={firstName:[{required:!0,message:"O Nome é obrigatório",trigger:"blur"},{max:100,message:"O Nome deve ter no máximo 100 caracteres",trigger:"blur"}],lastName:[{required:!0,message:"O Sobrenome é obrigatório",trigger:"blur"},{max:200,message:"O Sobrenome deve ter no máximo 200 caracteres",trigger:"blur"}],userEmail:[{required:!0,message:"O Email é obrigatório",trigger:"blur"},{type:"email",message:"O Email está inválido",trigger:"blur"}],password:[{required:!0,validator:p,trigger:"blur"},{min:6,message:"A senha deve ter pelo menos 6 caracteres",trigger:"blur"}],confirmPassword:[{required:!0,validator:m,trigger:"blur"}]},j=async i=>{N.value=2},q=i=>{},I=b(),F=P({companyName:"",bussinessName:"",cnpj:""}),J=i=>{const s=i.replace(/[^\d]/g,"");let n=s;return s.length>12?n=`${s.slice(0,2)}.${s.slice(2,5)}.${s.slice(5,8)}/${s.slice(8,12)}-${s.slice(12,14)}`:s.length>8?n=`${s.slice(0,2)}.${s.slice(2,5)}.${s.slice(5,8)}/${s.slice(8)}`:s.length>5?n=`${s.slice(0,2)}.${s.slice(2,5)}.${s.slice(5)}`:s.length>2&&(n=`${s.slice(0,2)}.${s.slice(2)}`),n};return{isLogin:e,tooggleLoginRegister:_,currentStep:N,goBack:k,userFormRef:R,userState:t,userRules:A,handleUserRegistration:j,handleUserRegistrationFailed:q,clientState:F,clientRules:{companyName:[{required:!0,message:"A Razão Social é Obrigatória",trigger:"blur"},{max:400,message:"A Razão Social deve ter no máximo 400 caracteres",trigger:"blur"}],bussinessName:[{required:!0,message:"O Nome Fantasia é obrigatório",trigger:"blur"},{max:400,message:"O Nome Fantasia deve ter no máximo 40 caracteres",trigger:"blur"}],cnpj:[{required:!0,message:"O CNPJ é obrigatório",trigger:"blur"},{max:18,message:"O CNPJ deve ter 18 caracteres",trigger:"blur"},{min:18,message:"O CNPJ deve ter 18 caracteres",trigger:"blur"}]},loading:d,handleClientRegistration:async()=>{try{d.value=!0;const i={firstName:t.firstName,lastName:t.lastName,userEmail:t.userEmail,userPassword:t.password,companyName:F.companyName,bussinessName:F.bussinessName,cnpj:F.cnpj};await U.post("auth/register",i),d.value=!1,G({successTitle:"Conta Registrada com Sucesso!",successMessage:"Entre agora mesmo na plataforma"}),_()}catch(i){let s=i.response.data;if(d.value=!1,$(s),s.validationErrors){const n=s.validationErrors.map(L=>L.identifier);(n.includes("UserEmail")||n.includes("UserPassword")||n.includes("FirstName")||n.includes("LastName"))&&(N.value=1)}}},handleClientRegistrationFailed:i=>{},onInput:i=>{const n=i.target.value;F.cnpj=J(n)},clientFormRef:I,userLoginFormRef:l,userLoginState:f,userLoginRules:S,handleUserLogin:c,handleUserLoginFailed:E}},components:{UserOutlined:V,LockOutlined:W,ArrowLeftOutlined:M}}),Y="/Ollix-Frontend/background-auth.jpg",Z="/Ollix-Frontend/logo-ollix.svg";const y=e=>(K("data-v-37f65eeb"),e=e(),Q(),e),x={class:"register-container"},ee=y(()=>u("div",{class:"background"},[u("img",{src:Y,class:"background-image"})],-1)),ae={class:"register-form"},se=y(()=>u("img",{src:Z,alt:"Logo",class:"logo",title:"Oliix"},null,-1)),re=y(()=>u("p",{class:"description"}," Energia eólica a partir do vento gerado pelos carros ",-1)),te={key:0},oe=y(()=>u("h3",{class:"title"},"Entre agora na Plataforma!",-1)),ie={style:{"text-align":"center"}},le={key:1},ne=y(()=>u("h3",{class:"title"},"Registre-se na Plataforma!",-1)),ue=y(()=>u("h3",{class:"title"},"Agora Registre sua Empresa!",-1)),me={style:{"text-align":"center"}};function de(e,o,N,d,_,k){const p=g("UserOutlined"),m=g("a-input"),l=g("a-form-item"),f=g("LockOutlined"),S=g("a-input-password"),c=g("a-button"),E=g("a-form"),R=g("ArrowLeftOutlined");return h(),C("div",x,[ee,u("div",ae,[se,re,e.isLogin?(h(),C("div",te,[a(E,{ref:"userLoginFormRef",model:e.userLoginState,rules:e.userLoginRules,layout:"vertical",onFinish:e.handleUserLogin,onFinishFailed:e.handleUserLoginFailed,style:{width:"22rem"}},{default:r(()=>[oe,a(l,{label:"Email",name:"userEmail"},{default:r(()=>[a(m,{value:e.userLoginState.userEmail,"onUpdate:value":o[0]||(o[0]=t=>e.userLoginState.userEmail=t),placeholder:"Email"},{prefix:r(()=>[a(p,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,{label:"Senha",name:"password"},{default:r(()=>[a(S,{value:e.userLoginState.password,"onUpdate:value":o[1]||(o[1]=t=>e.userLoginState.password=t),placeholder:"Senha"},{prefix:r(()=>[a(f,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,null,{default:r(()=>[a(c,{type:"primary","html-type":"submit",class:"register-button",loading:e.loading},{default:r(()=>[v("Entrar")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","onFinish","onFinishFailed"]),u("p",ie,[v(" Não possui uma conta? "),a(c,{onClick:e.tooggleLoginRegister,size:"small",type:"link"},{default:r(()=>[v(" Registre-se Aqui")]),_:1},8,["onClick"])])])):w("",!0),e.isLogin?w("",!0):(h(),C("div",le,[e.currentStep===1?(h(),O(E,{key:0,ref:"userFormRef",model:e.userState,rules:e.userRules,layout:"vertical",onFinish:e.handleUserRegistration,onFinishFailed:e.handleUserRegistrationFailed,style:{width:"22rem"}},{default:r(()=>[ne,a(l,{label:"Primeiro Nome",name:"firstName"},{default:r(()=>[a(m,{value:e.userState.firstName,"onUpdate:value":o[2]||(o[2]=t=>e.userState.firstName=t),placeholder:"Nome"},{prefix:r(()=>[a(p,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,{label:"Último Nome",name:"lastName"},{default:r(()=>[a(m,{value:e.userState.lastName,"onUpdate:value":o[3]||(o[3]=t=>e.userState.lastName=t),placeholder:"Sobrenome"},{prefix:r(()=>[a(p,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,{label:"Email",name:"userEmail"},{default:r(()=>[a(m,{value:e.userState.userEmail,"onUpdate:value":o[4]||(o[4]=t=>e.userState.userEmail=t),placeholder:"Email"},{prefix:r(()=>[a(p,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,{label:"Senha",name:"password"},{default:r(()=>[a(S,{value:e.userState.password,"onUpdate:value":o[5]||(o[5]=t=>e.userState.password=t),placeholder:"Senha"},{prefix:r(()=>[a(f,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,{label:"Confirme a Senha",name:"confirmPassword"},{default:r(()=>[a(S,{value:e.userState.confirmPassword,"onUpdate:value":o[6]||(o[6]=t=>e.userState.confirmPassword=t),placeholder:"Confirmação de Senha"},{prefix:r(()=>[a(f,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,null,{default:r(()=>[a(c,{type:"primary","html-type":"submit",class:"register-button"},{default:r(()=>[v("Proximo Passo")]),_:1})]),_:1})]),_:1},8,["model","rules","onFinish","onFinishFailed"])):w("",!0),e.currentStep===2?(h(),O(E,{key:1,ref:"clientFormRef",model:e.clientState,rules:e.clientRules,layout:"vertical",onFinish:e.handleClientRegistration,onFinishFailed:e.handleClientRegistrationFailed,style:{width:"22rem"}},{default:r(()=>[ue,e.currentStep===2?(h(),O(c,{key:0,style:{"margin-bottom":"15px"},onClick:e.goBack,type:"text",shape:"circle"},{icon:r(()=>[a(R)]),_:1},8,["onClick"])):w("",!0),a(l,{label:"Razão Social",name:"companyName"},{default:r(()=>[a(m,{value:e.clientState.companyName,"onUpdate:value":o[7]||(o[7]=t=>e.clientState.companyName=t),placeholder:"Razão Social"},null,8,["value"])]),_:1}),a(l,{label:"Nome Fantasia",name:"bussinessName"},{default:r(()=>[a(m,{value:e.clientState.bussinessName,"onUpdate:value":o[8]||(o[8]=t=>e.clientState.bussinessName=t),placeholder:"Nome Fantasia"},null,8,["value"])]),_:1}),a(l,{label:"CNPJ",name:"cnpj"},{default:r(()=>[a(m,{value:e.clientState.cnpj,"onUpdate:value":o[9]||(o[9]=t=>e.clientState.cnpj=t),placeholder:"CNPJ","max-length":18,onInput:e.onInput},null,8,["value","onInput"])]),_:1}),a(l,null,{default:r(()=>[a(c,{type:"primary","html-type":"submit",class:"register-button",loading:e.loading},{default:r(()=>[v("Confirmar")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","onFinish","onFinishFailed"])):w("",!0),u("p",me,[v(" Já possui uma conta? "),a(c,{onClick:e.tooggleLoginRegister,size:"small",type:"link"},{default:r(()=>[v(" Entre aqui")]),_:1},8,["onClick"])])]))])])}const he=H(X,[["render",de],["__scopeId","data-v-37f65eeb"]]);export{he as default};
