import{c as a,A as B,d as M,r as y,u as H,a as L,U as D,b as T,e as $,S as G,s as Q,n as A,f as W,_ as X,g as f,o as S,h as P,i as m,w as r,j as b,k as _,l as k,p as Y,m as Z}from"./index-3547e6e8.js";var x={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};const K=x;function j(e){for(var s=1;s<arguments.length;s++){var i=arguments[s]!=null?Object(arguments[s]):{},d=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(d=d.concat(Object.getOwnPropertySymbols(i).filter(function(g){return Object.getOwnPropertyDescriptor(i,g).enumerable}))),d.forEach(function(g){ee(e,g,i[g])})}return e}function ee(e,s,i){return s in e?Object.defineProperty(e,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[s]=i,e}var C=function(s,i){var d=j({},s,i.attrs);return a(B,j({},d,{icon:K}),null)};C.displayName="LockOutlined";C.inheritAttrs=!1;const ae=C,te=M({name:"Authentication",setup(){const e=y(!0),s=H(),i=y(1),d=y(!1),g=()=>{e.value=!e.value},U=()=>{i.value=1},v=(n,t)=>t===""?Promise.reject("Por favor, insira a senha."):Promise.resolve(),c=(n,t)=>t===""?Promise.reject("Por favor, confirme a senha."):t!==o.password?Promise.reject("As senhas não coincidem."):Promise.resolve(),l=y(),h=L({userEmail:"",password:""}),O={userEmail:[{required:!0,message:"O Email é obrigatório",trigger:"blur"},{type:"email",message:"O Email está inválido",trigger:"blur"}],password:[{required:!0,validator:v,trigger:"blur"},{min:6,message:"A senha deve ter pelo menos 6 caracteres",trigger:"blur"}]},p=async()=>{var n;try{d.value=!0;const t={userEmail:h.userEmail,userPassword:h.password},R=(await $.post("auth/login",t)).data;d.value=!1,G(R),Q.getters.isAdmin?await s.push("/admin"):await s.push("/")}catch(t){let u=(n=t==null?void 0:t.response)==null?void 0:n.data;d.value=!1,A(u)}},w=n=>{},F=y(),o=L({firstName:"",lastName:"",userEmail:"",password:"",confirmPassword:""}),q={firstName:[{required:!0,message:"O Nome é obrigatório",trigger:"blur"},{max:100,message:"O Nome deve ter no máximo 100 caracteres",trigger:"blur"}],lastName:[{required:!0,message:"O Sobrenome é obrigatório",trigger:"blur"},{max:200,message:"O Sobrenome deve ter no máximo 200 caracteres",trigger:"blur"}],userEmail:[{required:!0,message:"O Email é obrigatório",trigger:"blur"},{type:"email",message:"O Email está inválido",trigger:"blur"}],password:[{required:!0,validator:v,trigger:"blur"},{min:6,message:"A senha deve ter pelo menos 6 caracteres",trigger:"blur"}],confirmPassword:[{required:!0,validator:c,trigger:"blur"}]},I=async n=>{i.value=2},z=n=>{},J=y(),E=L({companyName:"",bussinessName:"",cnpj:""}),V=n=>{const t=n.replace(/[^\d]/g,"");let u=t;return t.length>12?u=`${t.slice(0,2)}.${t.slice(2,5)}.${t.slice(5,8)}/${t.slice(8,12)}-${t.slice(12,14)}`:t.length>8?u=`${t.slice(0,2)}.${t.slice(2,5)}.${t.slice(5,8)}/${t.slice(8)}`:t.length>5?u=`${t.slice(0,2)}.${t.slice(2,5)}.${t.slice(5)}`:t.length>2&&(u=`${t.slice(0,2)}.${t.slice(2)}`),u};return{isLogin:e,tooggleLoginRegister:g,currentStep:i,goBack:U,userFormRef:F,userState:o,userRules:q,handleUserRegistration:I,handleUserRegistrationFailed:z,clientState:E,clientRules:{companyName:[{required:!0,message:"A Razão Social é Obrigatória",trigger:"blur"},{max:400,message:"A Razão Social deve ter no máximo 400 caracteres",trigger:"blur"}],bussinessName:[{required:!0,message:"O Nome Fantasia é obrigatório",trigger:"blur"},{max:400,message:"O Nome Fantasia deve ter no máximo 40 caracteres",trigger:"blur"}],cnpj:[{required:!0,message:"O CNPJ é obrigatório",trigger:"blur"},{max:18,message:"O CNPJ deve ter 18 caracteres",trigger:"blur"},{min:18,message:"O CNPJ deve ter 18 caracteres",trigger:"blur"}]},loading:d,handleClientRegistration:async()=>{try{d.value=!0;const n={firstName:o.firstName,lastName:o.lastName,userEmail:o.userEmail,userPassword:o.password,companyName:E.companyName,bussinessName:E.bussinessName,cnpj:E.cnpj};await $.post("auth/register",n),d.value=!1,W({successTitle:"Conta Registrada com Sucesso!",successMessage:"Entre agora mesmo na plataforma"}),g()}catch(n){let t=n.response.data;if(d.value=!1,A(t),t.validationErrors){const u=t.validationErrors.map(R=>R.identifier);(u.includes("UserEmail")||u.includes("UserPassword")||u.includes("FirstName")||u.includes("LastName"))&&(i.value=1)}}},handleClientRegistrationFailed:n=>{},onInput:n=>{const u=n.target.value;E.cnpj=V(u)},clientFormRef:J,userLoginFormRef:l,userLoginState:h,userLoginRules:O,handleUserLogin:p,handleUserLoginFailed:w}},components:{UserOutlined:D,LockOutlined:ae,ArrowLeftOutlined:T}}),se="/Ollix-Frontend/background-auth.jpg",re="/Ollix-Frontend/logo-ollix.svg";const N=e=>(Y("data-v-fd676ecf"),e=e(),Z(),e),oe={class:"register-container"},ne=N(()=>m("div",{class:"background"},[m("img",{src:se,class:"background-image"})],-1)),ie={class:"register-form"},le=N(()=>m("img",{src:re,alt:"Logo",class:"logo",title:"Oliix"},null,-1)),ue=N(()=>m("p",{class:"description"}," Energia eólica a partir do vento gerado pelos carros ",-1)),de={key:0},me=N(()=>m("h3",{class:"title"},"Entre agora na Plataforma!",-1)),ce={style:{"text-align":"center"}},ge={key:1},pe=N(()=>m("h3",{class:"title"},"Registre-se na Plataforma!",-1)),fe=N(()=>m("h3",{class:"title"},"Agora Registre sua Empresa!",-1)),ve={style:{"text-align":"center"}};function he(e,s,i,d,g,U){const v=f("UserOutlined"),c=f("a-input"),l=f("a-form-item"),h=f("LockOutlined"),O=f("a-input-password"),p=f("a-button"),w=f("a-form"),F=f("ArrowLeftOutlined");return S(),P("div",oe,[ne,m("div",ie,[le,ue,e.isLogin?(S(),P("div",de,[a(w,{ref:"userLoginFormRef",model:e.userLoginState,rules:e.userLoginRules,layout:"vertical",onFinish:e.handleUserLogin,onFinishFailed:e.handleUserLoginFailed,style:{width:"22rem"}},{default:r(()=>[me,a(l,{label:"Email",name:"userEmail"},{default:r(()=>[a(c,{value:e.userLoginState.userEmail,"onUpdate:value":s[0]||(s[0]=o=>e.userLoginState.userEmail=o),placeholder:"Email"},{prefix:r(()=>[a(v,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,{label:"Senha",name:"password"},{default:r(()=>[a(O,{value:e.userLoginState.password,"onUpdate:value":s[1]||(s[1]=o=>e.userLoginState.password=o),placeholder:"Senha"},{prefix:r(()=>[a(h,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,null,{default:r(()=>[a(p,{type:"primary","html-type":"submit",class:"register-button",loading:e.loading},{default:r(()=>[b("Entrar")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","onFinish","onFinishFailed"]),m("p",ce,[b(" Não possui uma conta? "),a(p,{onClick:e.tooggleLoginRegister,size:"small",type:"link"},{default:r(()=>[b(" Registre-se Aqui")]),_:1},8,["onClick"])])])):_("",!0),e.isLogin?_("",!0):(S(),P("div",ge,[e.currentStep===1?(S(),k(w,{key:0,ref:"userFormRef",model:e.userState,rules:e.userRules,layout:"vertical",onFinish:e.handleUserRegistration,onFinishFailed:e.handleUserRegistrationFailed,style:{width:"22rem"}},{default:r(()=>[pe,a(l,{label:"Primeiro Nome",name:"firstName"},{default:r(()=>[a(c,{value:e.userState.firstName,"onUpdate:value":s[2]||(s[2]=o=>e.userState.firstName=o),placeholder:"Nome"},{prefix:r(()=>[a(v,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,{label:"Último Nome",name:"lastName"},{default:r(()=>[a(c,{value:e.userState.lastName,"onUpdate:value":s[3]||(s[3]=o=>e.userState.lastName=o),placeholder:"Sobrenome"},{prefix:r(()=>[a(v,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,{label:"Email",name:"userEmail"},{default:r(()=>[a(c,{value:e.userState.userEmail,"onUpdate:value":s[4]||(s[4]=o=>e.userState.userEmail=o),placeholder:"Email"},{prefix:r(()=>[a(v,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,{label:"Senha",name:"password"},{default:r(()=>[a(O,{value:e.userState.password,"onUpdate:value":s[5]||(s[5]=o=>e.userState.password=o),placeholder:"Senha"},{prefix:r(()=>[a(h,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,{label:"Confirme a Senha",name:"confirmPassword"},{default:r(()=>[a(O,{value:e.userState.confirmPassword,"onUpdate:value":s[6]||(s[6]=o=>e.userState.confirmPassword=o),placeholder:"Confirmação de Senha"},{prefix:r(()=>[a(h,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(l,null,{default:r(()=>[a(p,{type:"primary","html-type":"submit",class:"register-button"},{default:r(()=>[b("Proximo Passo")]),_:1})]),_:1})]),_:1},8,["model","rules","onFinish","onFinishFailed"])):_("",!0),e.currentStep===2?(S(),k(w,{key:1,ref:"clientFormRef",model:e.clientState,rules:e.clientRules,layout:"vertical",onFinish:e.handleClientRegistration,onFinishFailed:e.handleClientRegistrationFailed,style:{width:"22rem"}},{default:r(()=>[fe,e.currentStep===2?(S(),k(p,{key:0,style:{"margin-bottom":"15px"},onClick:e.goBack,type:"text",shape:"circle"},{icon:r(()=>[a(F)]),_:1},8,["onClick"])):_("",!0),a(l,{label:"Razão Social",name:"companyName"},{default:r(()=>[a(c,{value:e.clientState.companyName,"onUpdate:value":s[7]||(s[7]=o=>e.clientState.companyName=o),placeholder:"Razão Social"},null,8,["value"])]),_:1}),a(l,{label:"Nome Fantasia",name:"bussinessName"},{default:r(()=>[a(c,{value:e.clientState.bussinessName,"onUpdate:value":s[8]||(s[8]=o=>e.clientState.bussinessName=o),placeholder:"Nome Fantasia"},null,8,["value"])]),_:1}),a(l,{label:"CNPJ",name:"cnpj"},{default:r(()=>[a(c,{value:e.clientState.cnpj,"onUpdate:value":s[9]||(s[9]=o=>e.clientState.cnpj=o),placeholder:"CNPJ","max-length":18,onInput:e.onInput},null,8,["value","onInput"])]),_:1}),a(l,null,{default:r(()=>[a(p,{type:"primary","html-type":"submit",class:"register-button",loading:e.loading},{default:r(()=>[b("Confirmar")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","onFinish","onFinishFailed"])):_("",!0),m("p",ve,[b(" Já possui uma conta? "),a(p,{onClick:e.tooggleLoginRegister,size:"small",type:"link"},{default:r(()=>[b(" Entre aqui")]),_:1},8,["onClick"])])]))])])}const we=X(te,[["render",he],["__scopeId","data-v-fd676ecf"]]);export{we as default};
