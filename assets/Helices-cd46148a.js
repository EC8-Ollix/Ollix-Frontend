import{u as Y}from"./useNavigation-9f8c9617.js";import{d as Z,A as J,H as K,B as ee,Y as te,r as f,D as ae,v as oe,F as se,a as ne,b as M,n as G,R as le,_ as ie,e as c,o as g,f as _,k as Q,j as H,h as t,w as a,V as W,G as P,g as l,Z as de,i as m,y as E,X as re,p as pe,l as ue}from"./index-0bd96fdb.js";import{H as ce}from"./HelicesByAddress-ca9f69c5.js";import{S as fe}from"./SmileOutlined-a725f085.js";import{F as ge}from"./FileSearchOutlined-16dc98a3.js";import"./dateHelper-d63eedb5.js";const me=Z({name:"AdressesHelices",components:{SmileOutlined:fe,FileSearchOutlined:ge,ArrowLeftOutlined:J,ControlOutlined:K,SearchOutlined:ee,HelicesByAddress:ce,InfoCircleOutlined:te},props:{clientId:{type:String},viaClientScreen:{type:Boolean,required:!0}},setup(e){const d=f(!0),q=f("");function F(u){q.value=u,d.value=!d.value}const{goBack:x}=Y(),V=f(0),N=[{title:"CEP",dataIndex:"postalCode",width:"7%"},{title:"Rua",dataIndex:"street",width:"27%"},{title:"Bairro",dataIndex:"neighborhood",width:"25%"},{title:"Cidade/Estado",dataIndex:"cityState",width:"25%"},{title:"Qtd. de Hélices",dataIndex:"propellersCount",width:"10%"},{title:"Ações",dataIndex:"actions",width:"5%"}],B=f(["5","10","20","40","50"]),b=f([]),C=f(!1),p=f({page:1,pageSize:10}),v=ae(),w=async u=>{var i;await T(),C.value=!0;const s={installed:!0,...o,...p.value};u&&(s.page=1),v.params.clientId&&(s.clientId=v.params.clientId);try{const r=await M.get("/propellers/propeller-adresses",{params:s});b.value=r.data.data,p.value.page=r.data.page,p.value.pageSize=r.data.pageSize,V.value=r.data.totalRecords}catch(r){let X=(i=r==null?void 0:r.response)==null?void 0:i.data;G(X)}finally{C.value=!1}},I=f([]);oe(()=>w(!1));let y=[];const T=async()=>{var u;try{y=(await M.get("/adresses",{params:{clientId:v.params.clientId}})).data;const i=new Set;I.value=y.filter(r=>i.has(r.state)?!1:(i.add(r.state),!0)).map(r=>({value:r.state,label:r.state}))}catch(s){let i=(u=s==null?void 0:s.response)==null?void 0:u.data;G(i)}};se(p,()=>w(!1),{deep:!0});const O=(u,s)=>{p.value.page=u,p.value.pageSize=s,s!==(p==null?void 0:p.value.pageSize)&&(b.value=[])},R=async()=>{d.value=!0,await w(!0)},o=ne({postalCode:void 0,street:void 0,neighborhood:void 0,city:void 0,state:void 0}),L=()=>{z.value=!1,o.postalCode=void 0,o.street=void 0,o.neighborhood=void 0,o.city=void 0,o.state=void 0},k=f(!0),A=u=>{const s=u.replace(/[^\d]/g,"");let i=s;return s.length>5?i=`${s.slice(0,5)}-${s.slice(5,8)}`:i=s,i.slice(0,9)},z=f(!1),n=u=>{const i=u.target.value;o.postalCode=A(i),o.street="",o.neighborhood="",o.city=void 0,o.state=void 0,o.postalCode.length>0?z.value=!0:z.value=!1,o.postalCode.length===9?h(i):o.postalCode.length>0&&$()};function $(){o.street="Verifique seu CEP",o.neighborhood="Verifique seu CEP",o.city="Verifique seu CEP",o.state="Verifique seu CEP"}const h=async u=>{try{const s=u.replace("-",""),i=await le.get(`https://viacep.com.br/ws/${s}/json/`);i.data&&i.data.logradouro?(o.street=`${i.data.logradouro}`,o.neighborhood=`${i.data.bairro}`,o.city=`${i.data.localidade}`,o.state=`${i.data.uf}`,k.value=!0):($(),k.value=!1)}catch{$(),k.value=!1}},D=(u,s)=>s.value.toLowerCase().indexOf(u.toLowerCase())>=0,j=f([]),U=f(!1);return{goBack:x,data:b,loading:C,pagination:p,columns:N,onShowSizeChange:O,pageSizeOptions:B,totalRecords:V,showOriginalTable:d,toggleTable:F,selectedAddress:q,route:v,limpaPesquisa:L,handlePesquisa:R,formState:o,onInputCep:n,handleStateChange:u=>{U.value=!0;const s=y.filter(r=>r.state===u).map(r=>r.city),i=Array.from(new Set(s));j.value=i.map(r=>({value:r,label:r})),U.value=!1},stateOptions:I,filterOption:D,isCepInformed:z,cityOptions:j,isLoadingCityOptions:U,formatCEP:A}}});const S=e=>(pe("data-v-1ba60356"),e=e(),ue(),e),ve={class:"filtros"},he=S(()=>l("h3",null,"Filtros",-1)),Ce={class:"perso-label"},ye=S(()=>l("div",{class:"perso-label"},"Rua",-1)),_e=S(()=>l("div",{class:"perso-label"}," Bairro ",-1)),Se={class:"perso-label"},be={style:{"text-align":"center",padding:"10px"}},we=S(()=>l("p",null,"Nada encontrado",-1)),Ie=S(()=>l("div",{class:"perso-label"}," Estado ",-1)),Oe={style:{"text-align":"center",padding:"10px"}},ze=S(()=>l("p",null,"Nada encontrado",-1)),Ee={class:"button-form-item"},ke={class:"button-form-item"},Pe={key:0},Be={class:"table-results"},Ae={style:{"text-align":"center",padding:"25px"}},$e=S(()=>l("p",null,"Nada encontrado",-1)),He={key:1};function qe(e,d,q,F,x,V){const N=c("a-page-header"),B=c("InfoCircleOutlined"),b=c("a-tooltip"),C=c("a-input"),p=c("a-col"),v=c("smile-outlined"),w=c("a-select"),I=c("a-config-provider"),y=c("a-row"),T=c("SearchOutlined"),O=c("a-button"),R=c("ControlOutlined"),o=c("a-table"),L=c("a-pagination"),k=c("ArrowLeftOutlined"),A=c("HelicesByAddress"),z=c("a-layout-content");return g(),_(P,null,[e.viaClientScreen?H("",!0):(g(),Q(N,{key:0,class:"pageHeader",title:"Hélices",onBack:e.goBack},null,8,["onBack"])),t(z,{style:W(e.viaClientScreen?{}:{margin:"10px 16px 25px"})},{default:a(()=>[l("div",{style:W(e.viaClientScreen?{}:{padding:"20px",background:"#fff"}),class:re({content:!e.viaClientScreen})},[t(de,{name:"slide"},{default:a(()=>[l("div",null,[l("div",ve,[he,t(y,null,{default:a(()=>[t(p,{class:"filtros-input",span:20},{default:a(()=>[t(y,null,{default:a(()=>[t(p,{span:3},{default:a(()=>[l("div",null,[l("div",Ce,[t(b,{title:"Ao informar o CEP, os demais campos não poderão ser alterados"},{default:a(()=>[t(B,{style:{"margin-right":"5px","font-size":"12px"}})]),_:1}),m(" CEP ")]),t(C,{value:e.formState.postalCode,"onUpdate:value":d[0]||(d[0]=n=>e.formState.postalCode=n),placeholder:"CEP","max-length":9,"min-length":9,onInput:e.onInputCep,style:{width:"100%"}},null,8,["value","onInput"])])]),_:1}),t(p,{span:6},{default:a(()=>[l("div",null,[ye,t(C,{value:e.formState.street,"onUpdate:value":d[1]||(d[1]=n=>e.formState.street=n),placeholder:"Rua",disabled:e.isCepInformed},null,8,["value","disabled"])])]),_:1}),t(p,{span:6},{default:a(()=>[l("div",null,[_e,t(C,{value:e.formState.neighborhood,"onUpdate:value":d[2]||(d[2]=n=>e.formState.neighborhood=n),placeholder:"Bairro",disabled:e.isCepInformed},null,8,["value","disabled"])])]),_:1}),t(p,{span:6},{default:a(()=>[l("div",null,[l("div",Se,[t(b,{title:"Escolha um Estado para selecionar uma Cidade"},{default:a(()=>[t(B,{style:{"margin-right":"5px","font-size":"12px"}})]),_:1}),m(" Cidade ")]),t(I,null,{renderEmpty:a(()=>[l("div",be,[t(v,{style:{"font-size":"15px"}}),we])]),default:a(()=>[t(w,{value:e.formState.city,"onUpdate:value":d[3]||(d[3]=n=>e.formState.city=n),"show-search":"",placeholder:"Cidade",style:{width:"100%"},options:e.cityOptions,"filter-option":e.filterOption,allowClear:!0,disabled:e.isCepInformed},null,8,["value","options","filter-option","disabled"])]),_:1})])]),_:1}),t(p,{span:3},{default:a(()=>[l("div",null,[Ie,t(I,null,{renderEmpty:a(()=>[l("div",Oe,[t(v,{style:{"font-size":"15px"}}),ze])]),default:a(()=>[t(w,{value:e.formState.state,"onUpdate:value":d[4]||(d[4]=n=>e.formState.state=n),"show-search":"",placeholder:"Estado",style:{width:"100%"},options:e.stateOptions,"filter-option":e.filterOption,onChange:e.handleStateChange,allowClear:!0,disabled:e.isCepInformed},null,8,["value","options","filter-option","onChange","disabled"])]),_:1})])]),_:1})]),_:1})]),_:1}),t(p,{class:"filtros-button",span:4},{default:a(()=>[t(y,{style:{"justify-content":"space-between"}},{default:a(()=>[t(p,{span:15},{default:a(()=>[l("div",Ee,[t(O,{type:"primary",style:{width:"100%"},onClick:e.handlePesquisa},{default:a(()=>[t(T),m(" Pesquisar ")]),_:1},8,["onClick"])])]),_:1}),t(p,{span:8},{default:a(()=>[l("div",ke,[t(O,{style:{width:"100%"},onClick:e.limpaPesquisa},{default:a(()=>[m(" Limpar ")]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1})]),_:1})]),e.showOriginalTable?(g(),_("div",Pe,[l("div",Be,[t(I,null,{renderEmpty:a(()=>[l("div",Ae,[t(v,{style:{"font-size":"20px"}}),$e])]),default:a(()=>[t(o,{columns:e.columns,"data-source":e.data,pagination:!1,loading:e.loading,size:"small"},{bodyCell:a(({column:n,text:$,record:h})=>[n.dataIndex==="postalCode"?(g(),_(P,{key:0},[m(E(e.formatCEP(h.address.postalCode)),1)],64)):n.dataIndex==="street"?(g(),_(P,{key:1},[m(E(h.address.street),1)],64)):n.dataIndex==="neighborhood"?(g(),_(P,{key:2},[m(E(h.address.neighborhood),1)],64)):n.dataIndex==="cityState"?(g(),_(P,{key:3},[m(E(h.address.city)+"/"+E(h.address.state),1)],64)):n.dataIndex==="actions"?(g(),Q(O,{key:4,size:"small",onClick:D=>e.toggleTable(h.address.id)},{default:a(()=>[t(R),m("Hélices")]),_:2},1032,["onClick"])):H("",!0)]),_:1},8,["columns","data-source","loading"])]),_:1}),t(L,{current:e.pagination.page,"onUpdate:current":d[5]||(d[5]=n=>e.pagination.page=n),pageSize:e.pagination.pageSize,"onUpdate:pageSize":d[6]||(d[6]=n=>e.pagination.pageSize=n),"page-size-options":e.pageSizeOptions,"show-size-changer":"",total:e.totalRecords,onShowSizeChange:e.onShowSizeChange,style:{"text-align":"right",margin:"25px 0 15px 0"}},{buildOptionText:a(n=>[l("span",null,E(n.value)+"/pág",1)]),_:1},8,["current","pageSize","page-size-options","total","onShowSizeChange"])])])):H("",!0),e.showOriginalTable?H("",!0):(g(),_("div",He,[t(O,{title:"voltar",shape:"circle",type:"text",style:{"margin-bottom":"15px"},onClick:d[7]||(d[7]=n=>e.toggleTable(""))},{default:a(()=>[t(k)]),_:1}),t(A,{clientId:e.route.params.clientId,addressId:e.selectedAddress,viaClientScreen:!0},null,8,["clientId","addressId"])]))])]),_:1})],6)]),_:1},8,["style"])],64)}const xe=ie(me,[["render",qe],["__scopeId","data-v-1ba60356"]]);export{xe as default};
