import{u as de}from"./useNavigation-79450952.js";import{f as ue}from"./dateHelper-d63eedb5.js";import{J as me,K as pe,L as G,d as ce,M as g,N as K,O as X,Q as Z,T as fe,r as _,q as ge,t as ve,R as Se,B as _e,D as he,a as ee,V,e as ae,n as te,W as ye,X as be,Y as Ce,_ as we,g as i,o as C,h as M,l as z,k as I,c as a,w as t,Z as oe,F as Q,i as m,j as c,v as L,$ as qe,y as Oe,a0 as De,p as Ee,m as ke}from"./index-500a5486.js";import{g as Pe}from"./orderStatus-43cc2072.js";import{S as Ye}from"./SmileOutlined-fe228a35.js";var Me={exports:{}};(function(e,n){(function(P,O){e.exports=O(me)})(pe,function(P){function O(f){return f&&typeof f=="object"&&"default"in f?f:{default:f}}var N=O(P),D={name:"pt-br",weekdays:"domingo_segunda-feira_terça-feira_quarta-feira_quinta-feira_sexta-feira_sábado".split("_"),weekdaysShort:"dom_seg_ter_qua_qui_sex_sáb".split("_"),weekdaysMin:"Do_2ª_3ª_4ª_5ª_6ª_Sá".split("_"),months:"janeiro_fevereiro_março_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),monthsShort:"jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),ordinal:function(f){return f+"º"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY [às] HH:mm",LLLL:"dddd, D [de] MMMM [de] YYYY [às] HH:mm"},relativeTime:{future:"em %s",past:"há %s",s:"poucos segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"}};return N.default.locale(D,null,!0),D})})(Me);const ze={locale:"pt_BR",today:"Hoje",now:"Agora",backToToday:"Voltar para hoje",ok:"Ok",clear:"Limpar",month:"Mês",year:"Ano",timeSelect:"Selecionar hora",dateSelect:"Selecionar data",monthSelect:"Escolher mês",yearSelect:"Escolher ano",decadeSelect:"Escolher década",yearFormat:"YYYY",dateFormat:"D/M/YYYY",dayFormat:"D",dateTimeFormat:"D/M/YYYY HH:mm:ss",monthBeforeYear:!1,previousMonth:"Mês anterior (PageUp)",nextMonth:"Próximo mês (PageDown)",previousYear:"Ano anterior (Control + esquerda)",nextYear:"Próximo ano (Control + direita)",previousDecade:"Década anterior",nextDecade:"Próxima década",previousCentury:"Século anterior",nextCentury:"Próximo século",shortWeekDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},Ie=ze,Ne={placeholder:"Hora"},Te=Ne,Fe={lang:G({placeholder:"Selecionar data",rangePlaceholder:["Data inicial","Data final"]},Ie),timePickerLocale:G({},Te)},Le=Fe;g.locale("pt-br");const Re=ce({name:"Orders",props:{clientId:{type:String},viaClientScreen:{type:Boolean,required:!0}},components:{FileTextOutlined:K,SmileOutlined:Ye,SearchOutlined:X,PlusOutlined:Z,"a-table":fe},setup(e){const{goBack:n}=de(),P=_(["5","10","20","40","50"]),O=_(0),N=ge(),D=ve(()=>N.state.isAdmin),f=_([]),v=_(!1),{clientId:r,viaClientScreen:J}=Se(e),p=_({page:1,pageSize:10});let Y=[{title:"Status",dataIndex:"orderStatus",width:"10%"},{title:"Cliente",dataIndex:"client",width:"20%"},{title:"Nome",dataIndex:"requesterName",width:"25%"},{title:"Email",dataIndex:"requesterEmail",width:"20%"},{title:"Data da Solicitação",dataIndex:"requestDate",width:"15%"},{title:"Qtd.",dataIndex:"quantityRequested",width:"5%"},{title:"Ações",dataIndex:"actions",width:"5%"}];D.value||(Y=Y.filter(u=>u.dataIndex!=="client"));const S=async()=>{var l;v.value=!0;const u={requestedDateFrom:b.requestedDate[0].toDate(),requestedDateTo:b.requestedDate[1].toDate(),...b,...p.value};r.value&&(u.clientId=r.value);try{const s=await ae.get("/orders",{params:u});f.value=s.data.data,p.value.page=s.data.page,p.value.pageSize=s.data.pageSize,O.value=s.data.totalRecords}catch(s){let q=(l=s==null?void 0:s.response)==null?void 0:l.data;te(q)}finally{v.value=!1}};_e(S),he(p,S,{deep:!0});const R=(u,l)=>{p.value.page=u,p.value.pageSize=l,l!==(p==null?void 0:p.value.pageSize)&&(f.value=[])},h="DD/MM/YYYY",y=g(),j=g().subtract(30,"day"),B=_([{label:"Últimos 7 dias",value:[g().add(-7,"d"),g()]},{label:"Últimos 14 dias",value:[g().add(-14,"d"),g()]},{label:"Últimos 30 dias",value:[g().add(-30,"d"),g()]},{label:"Últimos 90 dias",value:[g().add(-90,"d"),g()]}]),T=_([g(j,h),g(y,h)]),b=ee({clientSearch:void 0,requesterSearch:void 0,requestedDate:T.value,orderStatus:void 0}),U={rules:[{type:"array"}]},$=async()=>{await S()},A=async()=>{b.clientSearch=void 0,b.requesterSearch=void 0,b.orderStatus=void 0,b.requestedDate=T.value},E=_(!0),x={requesterName:[{required:!0,message:"Digite o nome do solicitante",trigger:"change"},{max:200,message:"O Nome do Solicitante deve ter no máximo 200 caracteres",trigger:"blur"}],requesterEmail:[{required:!0,message:"Digite o nome do solicitante",trigger:"change"},{max:200,message:"O Nome do Solicitante deve ter no máximo 200 caracteres",trigger:"blur"}],observation:[{max:600,message:"A Observação deve ter no máximo 200 caracteres",trigger:"blur"}],quantityRequested:[{required:!0,message:"Obrigatório",trigger:"change"},{validator:(u,l)=>l>0?Promise.resolve():Promise.reject("Obrigatório"),trigger:"change"}],postalCode:[{required:!0,message:"O CEP é obrigatório",trigger:"change"},{min:9,max:9,message:"CEP Inválido",trigger:"blur"},{validator:(u,l)=>E.value?Promise.resolve():Promise.reject("CEP Inválido"),trigger:"blur"}]},H=_(!1),o=_(!1),F=_(),w=_(!1),d=ee({requesterName:"",requesterEmail:"",observation:"",postalCode:"",street:"",neighborhood:"",cityState:"",quantityRequested:0}),ne=u=>{const l=u.replace(/[^\d]/g,"");let s=l;return l.length>5?s=`${l.slice(0,5)}-${l.slice(5,8)}`:s=l,s.slice(0,9)},re=u=>{const s=u.target.value;d.postalCode=ne(s),d.postalCode.length===9&&le(s)},le=async u=>{try{d.street="",d.neighborhood="",d.cityState="";const s=u.replace("-",""),q=await ye.get(`https://viacep.com.br/ws/${s}/json/`);q.data&&q.data.logradouro?(d.street=`${q.data.logradouro}`,d.neighborhood=`${q.data.bairro}`,d.cityState=`${q.data.localidade}/${q.data.uf}`,E.value=!0):(l(),E.value=!1)}catch{l(),E.value=!1}function l(){d.street="Verifique seu CEP",d.neighborhood="Verifique seu CEP",d.cityState="Verifique seu CEP"}},se=async()=>{await F.value.validate().then(async()=>{var u;o.value=!0;try{await ae.post("/orders",d),await S(),o.value=!1,ie()}catch(l){o.value=!1;let s=(u=l==null?void 0:l.response)==null?void 0:u.data;te(s)}}).catch(u=>{})},ie=()=>{be.confirm({title:"Pedido Realizado com Sucesso!",icon:V(Ce,{style:"color:green;"}),content:V("div",{style:"padding-bottom:15px;"},"Deseja realizar um novo Pedido?"),okText:"Sim",okType:"primary",cancelText:"Não, obrigado",onOk(){d.street="",d.neighborhood="",d.cityState="",d.observation="",d.postalCode="",d.quantityRequested=0},onCancel(){w.value=!1,W()},centered:!0})},W=()=>{F.value.resetFields()};return{goBack:n,data:f,loading:v,pagination:p,columns:Y,onShowSizeChange:R,pageSizeOptions:P,totalRecords:O,formatStringDateToBR:ue,getTagForOrderStatus:Pe,FileTextOutlined:K,h:V,formState:b,handlePesquisa:$,rangeConfig:U,dateFormat:h,isAdmin:D,locale:Le,limpaPesquisa:A,rangePresets:B,SearchOutlined:X,PlusOutlined:Z,onNewOrderConfirm:se,newOrderState:d,formRef:F,visible:w,confirmLoading:o,rules:x,newOrderStepOne:H,onInputCep:re,resetForm:W}}});const k=e=>(Ee("data-v-95af6ffc"),e=e(),ke(),e),je={class:"filtros"},Be=k(()=>m("h3",null,"Filtros",-1)),Ue=k(()=>m("div",{class:"perso-label"},"Cliente",-1)),$e=k(()=>m("div",{class:"perso-label"},"Solicitante",-1)),Ae=k(()=>m("div",{class:"perso-label"}," Data da Solicitação ",-1)),xe=k(()=>m("div",{class:"perso-label"},"Status",-1)),He={class:"button-form-item"},Ve={class:"button-form-item"},Qe={key:0,class:"actions"},Je={class:"table-results"},We={style:{"text-align":"center",padding:"25px"}},Ge=k(()=>m("p",null,"Nada encontrado",-1)),Ke={key:3};function Xe(e,n,P,O,N,D){const f=i("a-page-header"),v=i("a-input"),r=i("a-col"),J=i("a-range-picker"),p=i("a-select-option"),Y=i("a-select"),S=i("a-row"),R=i("SearchOutlined"),h=i("a-button"),y=i("a-form-item"),j=i("a-textarea"),B=i("a-input-number"),T=i("a-form"),b=i("a-modal"),U=i("smile-outlined"),$=i("a-tag"),A=i("a-table"),E=i("a-config-provider"),x=i("a-pagination"),H=i("a-layout-content");return C(),M(Q,null,[e.viaClientScreen?I("",!0):(C(),z(f,{key:0,class:"pageHeader",title:"Pedidos",onBack:e.goBack},null,8,["onBack"])),a(H,{style:oe(e.viaClientScreen?{}:{margin:"10px 16px 25px"})},{default:t(()=>[m("div",{style:oe(e.viaClientScreen?{}:{padding:"20px",background:"#fff"}),class:De({content:!e.viaClientScreen})},[m("div",je,[Be,a(S,null,{default:t(()=>[a(r,{class:"filtros-input",span:19},{default:t(()=>[a(S,null,{default:t(()=>[e.isAdmin?(C(),z(r,{key:0,span:8},{default:t(()=>[m("div",null,[Ue,a(v,{value:e.formState.clientSearch,"onUpdate:value":n[0]||(n[0]=o=>e.formState.clientSearch=o),placeholder:"Cliente"},null,8,["value"])])]),_:1})):I("",!0),e.isAdmin?I("",!0):(C(),z(r,{key:1,span:8},{default:t(()=>[m("div",null,[$e,a(v,{value:e.formState.requesterSearch,"onUpdate:value":n[1]||(n[1]=o=>e.formState.requesterSearch=o),placeholder:"Solicitante"},null,8,["value"])])]),_:1})),a(r,{span:9},{default:t(()=>[m("div",null,[Ae,a(J,{value:e.formState.requestedDate,"onUpdate:value":n[2]||(n[2]=o=>e.formState.requestedDate=o),format:e.dateFormat,style:{width:"100%"},locale:e.locale,presets:e.rangePresets},null,8,["value","format","locale","presets"])])]),_:1}),a(r,{span:7},{default:t(()=>[m("div",null,[xe,a(Y,{value:e.formState.orderStatus,"onUpdate:value":n[3]||(n[3]=o=>e.formState.orderStatus=o),placeholder:"Status",style:{width:"100%"},allowClear:""},{default:t(()=>[a(p,{value:"1"},{default:t(()=>[c("Pendente")]),_:1}),a(p,{value:"2"},{default:t(()=>[c("Instalação Pendente")]),_:1}),a(p,{value:"3"},{default:t(()=>[c("Finalizado")]),_:1}),a(p,{value:"4"},{default:t(()=>[c("Negado")]),_:1}),a(p,{value:"5"},{default:t(()=>[c("Cancelado")]),_:1})]),_:1},8,["value"])])]),_:1})]),_:1})]),_:1}),a(r,{class:"filtros-button",span:5},{default:t(()=>[a(S,{style:{"justify-content":"space-between"}},{default:t(()=>[a(r,{span:15},{default:t(()=>[m("div",He,[a(h,{type:"primary",style:{width:"100%"},onClick:e.handlePesquisa},{default:t(()=>[a(R),c(" Pesquisar ")]),_:1},8,["onClick"])])]),_:1}),a(r,{span:8},{default:t(()=>[m("div",Ve,[a(h,{style:{width:"100%"},onClick:e.limpaPesquisa},{default:t(()=>[c(" Limpar ")]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1})]),_:1})]),e.isAdmin?I("",!0):(C(),M("div",Qe,[a(S,{style:{"place-content":"start"}},{default:t(()=>[a(r,null,{default:t(()=>[a(h,{type:"default",icon:e.h(e.PlusOutlined),onClick:n[4]||(n[4]=o=>e.visible=!0)},{default:t(()=>[c("Novo Pedido")]),_:1},8,["icon"])]),_:1})]),_:1})])),a(b,{open:e.visible,"onUpdate:open":n[13]||(n[13]=o=>e.visible=o),title:"Realize seu Pedido de Hélices!","confirm-loading":e.confirmLoading,width:"750px"},{footer:t(()=>[a(h,{style:{"margin-left":"10px"},onClick:e.resetForm},{default:t(()=>[c("Limpar")]),_:1},8,["onClick"]),a(h,{type:"primary",onClick:e.onNewOrderConfirm},{default:t(()=>[c("Confirmar Pedido")]),_:1},8,["onClick"])]),default:t(()=>[a(T,{ref:"formRef",rules:e.rules,model:e.newOrderState,layout:"vertical",name:"form_in_modal"},{default:t(()=>[a(S,{style:{"margin-top":"15px"}},{default:t(()=>[a(r,{span:12},{default:t(()=>[a(y,{name:"requesterName",label:"Nome"},{default:t(()=>[a(v,{value:e.newOrderState.requesterName,"onUpdate:value":n[5]||(n[5]=o=>e.newOrderState.requesterName=o),placeholder:"Nome"},null,8,["value"])]),_:1})]),_:1}),a(r,{span:1}),a(r,{span:11},{default:t(()=>[a(y,{name:"requesterEmail",label:"Email"},{default:t(()=>[a(v,{value:e.newOrderState.requesterEmail,"onUpdate:value":n[6]||(n[6]=o=>e.newOrderState.requesterEmail=o),placeholder:"Email"},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(y,{name:"observation",label:"Observação"},{default:t(()=>[a(j,{value:e.newOrderState.observation,"onUpdate:value":n[7]||(n[7]=o=>e.newOrderState.observation=o),placeholder:"Observação"},null,8,["value"])]),_:1}),a(S,{style:{"margin-top":"15px"}},{default:t(()=>[a(r,{span:3},{default:t(()=>[a(y,{name:"quantityRequested",label:"Quantidade"},{default:t(()=>[a(B,{value:e.newOrderState.quantityRequested,"onUpdate:value":n[8]||(n[8]=o=>e.newOrderState.quantityRequested=o),placeholder:"Qtde",min:1},null,8,["value"])]),_:1})]),_:1}),a(r,{span:1}),a(r,{span:5},{default:t(()=>[a(y,{name:"postalCode",label:"CEP"},{default:t(()=>[a(v,{value:e.newOrderState.postalCode,"onUpdate:value":n[9]||(n[9]=o=>e.newOrderState.postalCode=o),placeholder:"CEP","max-length":9,"min-length":9,onInput:e.onInputCep,style:{width:"100%"}},null,8,["value","onInput"])]),_:1})]),_:1}),a(r,{span:1}),a(r,{span:14},{default:t(()=>[a(y,{name:"address",label:"Endereço"},{default:t(()=>[a(v,{value:e.newOrderState.street,"onUpdate:value":n[10]||(n[10]=o=>e.newOrderState.street=o),placeholder:"Endereço",readonly:!0},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(S,null,{default:t(()=>[a(r,{span:9},{default:t(()=>[a(y,{name:"neighborhood",label:"Bairro"},{default:t(()=>[a(v,{value:e.newOrderState.neighborhood,"onUpdate:value":n[11]||(n[11]=o=>e.newOrderState.neighborhood=o),placeholder:"Bairro",readonly:!0},null,8,["value"])]),_:1})]),_:1}),a(r,{span:1}),a(r,{span:14},{default:t(()=>[a(y,{name:"cityState",label:"Cidade/Estado"},{default:t(()=>[a(v,{value:e.newOrderState.cityState,"onUpdate:value":n[12]||(n[12]=o=>e.newOrderState.cityState=o),placeholder:"Cidade/Estado",readonly:!0},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["open","confirm-loading"]),m("div",Je,[a(E,null,{renderEmpty:t(()=>[m("div",We,[a(U,{style:{"font-size":"20px"}}),Ge])]),default:t(()=>[a(A,{columns:e.columns,"data-source":e.data,pagination:!1,loading:e.loading,size:"small"},{bodyCell:t(({column:o,text:F,record:w})=>[o.dataIndex==="requestDate"?(C(),M(Q,{key:0},[c(L(e.formatStringDateToBR(w.requestDate)),1)],64)):o.dataIndex==="client"?(C(),M(Q,{key:1},[c(L(w.clientApp.bussinessName),1)],64)):o.dataIndex==="orderStatus"?(C(),z($,{key:2,color:e.getTagForOrderStatus(w.orderStatus).color},qe({default:t(()=>[c(" "+L(e.getTagForOrderStatus(w.orderStatus).text),1)]),_:2},[e.getTagForOrderStatus(w.orderStatus).icon?{name:"icon",fn:t(()=>[(C(),z(Oe(e.getTagForOrderStatus(w.orderStatus).icon)))]),key:"0"}:void 0]),1032,["color"])):o.dataIndex==="actions"?(C(),M("div",Ke,[a(h,{icon:e.h(e.FileTextOutlined),href:"https://www.google.com",size:"small"},{default:t(()=>[c(" Visualizar ")]),_:1},8,["icon"])])):I("",!0)]),_:1},8,["columns","data-source","loading"])]),_:1}),a(x,{current:e.pagination.page,"onUpdate:current":n[14]||(n[14]=o=>e.pagination.page=o),pageSize:e.pagination.pageSize,"onUpdate:pageSize":n[15]||(n[15]=o=>e.pagination.pageSize=o),"page-size-options":e.pageSizeOptions,"show-size-changer":"",total:e.totalRecords,onShowSizeChange:e.onShowSizeChange,style:{"text-align":"right",margin:"25px 0 15px 0"}},{buildOptionText:t(o=>[m("span",null,L(o.value)+"/pág",1)]),_:1},8,["current","pageSize","page-size-options","total","onShowSizeChange"])])],6)]),_:1},8,["style"])],64)}const na=we(Re,[["render",Xe],["__scopeId","data-v-95af6ffc"]]);export{na as default};
