import{u as D}from"./useNavigation-9f8c9617.js";import{d as G,N as L,U as H,C as $,m as K,q as Q,K as X,r as m,v as J,F as W,a as Y,Q as O,b as j,n as F,O as Z,_ as ee,e as r,o as E,f as T,k as ae,j as V,h as a,w as o,V as x,G as oe,g as C,i as I,y as te,X as se,p as ne,l as re}from"./index-0bd96fdb.js";import{L as ie}from"./LockOutlined-bdf14291.js";import{S as le}from"./SmileOutlined-a725f085.js";const de=G({name:"Users",components:{PlusOutlined:L,LockOutlined:ie,UserOutlined:H,SmileOutlined:le,CheckCircleOutlined:$},props:{clientId:{type:String},viaClientScreen:{type:Boolean,required:!0}},setup(e){const{goBack:t}=D(),B=K(),R=Q(()=>B.state.isAdmin),{clientId:h,viaClientScreen:A}=X(e),y=m(0),g=[{title:"Nome",dataIndex:"firstName",width:"33%"},{title:"Sobrenome",dataIndex:"lastName",width:"33%"},{title:"Email",dataIndex:"userEmail",width:"33%"}],N=m(["5","10","20","40","50"]),f=m([]),v=m(!1),i=m({page:1,pageSize:10}),S=async l=>{var c;v.value=!0;const n={...i.value};l&&(n.page=1),h.value&&(n.clientId=h.value||void 0);try{const u=await j.get("/users",{params:n});f.value=u.data.data,i.value.page=u.data.page,i.value.pageSize=u.data.pageSize,y.value=u.data.totalRecords}catch(u){let M=(c=u==null?void 0:u.response)==null?void 0:c.data;F(M)}finally{v.value=!1}};J(()=>S(!1)),W(i,()=>S(!1),{deep:!0});const P=(l,n)=>{i.value.page=l,i.value.pageSize=n,n!==(i==null?void 0:i.value.pageSize)&&(f.value=[])},w={firstName:[{required:!0,message:"O Nome é obrigatório",trigger:"blur"},{max:100,message:"O Nome deve ter no máximo 100 caracteres",trigger:"blur"}],lastName:[{required:!0,message:"O Sobrenome é obrigatório",trigger:"blur"},{max:200,message:"O Sobrenome deve ter no máximo 200 caracteres",trigger:"blur"}],userEmail:[{required:!0,message:"O Email é obrigatório",trigger:"blur"},{type:"email",message:"O Email está inválido",trigger:"blur"}],userPassword:[{required:!0,validator:(l,n)=>n===""?Promise.reject("Por favor, insira a senha."):Promise.resolve(),trigger:"blur"},{min:6,message:"A senha deve ter pelo menos 6 caracteres",trigger:"blur"}],confirmPassword:[{required:!0,validator:(l,n)=>n===""?Promise.reject("Por favor, confirme a senha."):n!==b.userPassword?Promise.reject("As senhas não coincidem."):Promise.resolve(),trigger:"blur"}]},d=m(!1),p=m(),_=m(!1),b=Y({firstName:"",lastName:"",userEmail:"",userPassword:"",confirmPassword:""}),k=async()=>{await p.value.validate().then(async()=>{var l;d.value=!0;try{const c=(await j.post("/users",b)).data;await S(!1),d.value=!1,s(c)}catch(n){d.value=!1;let c=(l=n==null?void 0:n.response)==null?void 0:l.data;F(c)}}).catch(l=>{})},s=l=>{Z.confirm({title:`Usuário ${l.firstName} ${l.lastName} criado com Sucesso!`,icon:O($,{style:"color:green;"}),content:O("div",{style:"padding-bottom:15px;"},"Deseja criar um novo Usuário?"),width:"490px",okText:"Sim",okType:"primary",cancelText:"Não, obrigado",onOk(){z()},onCancel(){_.value=!1,z()}})},z=()=>{p.value.resetFields()};return{goBack:t,data:f,loading:v,pagination:i,columns:g,onShowSizeChange:P,pageSizeOptions:N,totalRecords:y,isAdmin:R,newUserState:b,visible:_,formRef:p,confirmLoading:d,resetForm:z,onNewUserConfirm:k,userRules:w,PlusOutlined:L,h:O}}});const ue=e=>(ne("data-v-31aab8a0"),e=e(),re(),e),me={key:0,class:"actions"},pe={style:{"text-align":"center",padding:"25px"}},ce=ue(()=>C("p",null,"Nada encontrado",-1));function ge(e,t,B,R,h,A){const y=r("a-page-header"),g=r("a-button"),N=r("a-col"),f=r("a-row"),v=r("smile-outlined"),i=r("a-table"),S=r("a-config-provider"),P=r("a-pagination"),q=r("a-layout-content"),U=r("UserOutlined"),w=r("a-input"),d=r("a-form-item"),p=r("LockOutlined"),_=r("a-input-password"),b=r("a-form"),k=r("a-modal");return E(),T(oe,null,[e.viaClientScreen?V("",!0):(E(),ae(y,{key:0,class:"pageHeader",title:"Usuários",onBack:e.goBack},null,8,["onBack"])),a(q,{style:x(e.viaClientScreen?{}:{margin:"10px 16px 25px"})},{default:o(()=>[C("div",{style:x(e.viaClientScreen?{}:{padding:"20px",background:"#fff"}),class:se({content:!e.viaClientScreen})},[e.viaClientScreen?V("",!0):(E(),T("div",me,[a(f,{style:{"place-content":"start"}},{default:o(()=>[a(N,null,{default:o(()=>[a(g,{type:"default",icon:e.h(e.PlusOutlined),onClick:t[0]||(t[0]=s=>e.visible=!0)},{default:o(()=>[I("Novo Usuário")]),_:1},8,["icon"])]),_:1})]),_:1})])),a(S,null,{renderEmpty:o(()=>[C("div",pe,[a(v,{style:{"font-size":"20px"}}),ce])]),default:o(()=>[a(i,{columns:e.columns,"data-source":e.data,pagination:!1,loading:e.loading,size:"small"},null,8,["columns","data-source","loading"])]),_:1}),a(P,{current:e.pagination.page,"onUpdate:current":t[1]||(t[1]=s=>e.pagination.page=s),pageSize:e.pagination.pageSize,"onUpdate:pageSize":t[2]||(t[2]=s=>e.pagination.pageSize=s),"page-size-options":e.pageSizeOptions,"show-size-changer":"",total:e.totalRecords,onShowSizeChange:e.onShowSizeChange,style:{"text-align":"right",margin:"25px 0 15px 0"}},{buildOptionText:o(s=>[C("span",null,te(s.value)+"/pág",1)]),_:1},8,["current","pageSize","page-size-options","total","onShowSizeChange"])],6)]),_:1},8,["style"]),a(k,{open:e.visible,"onUpdate:open":t[8]||(t[8]=s=>e.visible=s),title:"Crie um novo Usuário",width:"480px"},{footer:o(()=>[a(g,{style:{"margin-left":"10px"},onClick:e.resetForm},{default:o(()=>[I("Limpar")]),_:1},8,["onClick"]),a(g,{type:"primary",onClick:e.onNewUserConfirm,loading:e.confirmLoading},{default:o(()=>[I("Criar Usuário")]),_:1},8,["onClick","loading"])]),default:o(()=>[a(b,{ref:"formRef",rules:e.userRules,model:e.newUserState,layout:"vertical",name:"form_in_modal"},{default:o(()=>[a(d,{name:"firstName",label:"Nome"},{default:o(()=>[a(w,{value:e.newUserState.firstName,"onUpdate:value":t[3]||(t[3]=s=>e.newUserState.firstName=s),placeholder:"Nome"},{prefix:o(()=>[a(U,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(d,{name:"lastName",label:"Sobrenome"},{default:o(()=>[a(w,{value:e.newUserState.lastName,"onUpdate:value":t[4]||(t[4]=s=>e.newUserState.lastName=s),placeholder:"Sobrenome"},{prefix:o(()=>[a(U,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(d,{name:"userEmail",label:"Email"},{default:o(()=>[a(w,{value:e.newUserState.userEmail,"onUpdate:value":t[5]||(t[5]=s=>e.newUserState.userEmail=s),placeholder:"Email"},{prefix:o(()=>[a(U,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(d,{name:"userPassword",label:"Senha"},{default:o(()=>[a(_,{value:e.newUserState.userPassword,"onUpdate:value":t[6]||(t[6]=s=>e.newUserState.userPassword=s),placeholder:"Senha"},{prefix:o(()=>[a(p,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1}),a(d,{name:"confirmPassword",label:"Confirme a Senha"},{default:o(()=>[a(_,{value:e.newUserState.confirmPassword,"onUpdate:value":t[7]||(t[7]=s=>e.newUserState.confirmPassword=s),placeholder:"Confirme a Senha"},{prefix:o(()=>[a(p,{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["open"])],64)}const _e=ee(de,[["render",ge],["__scopeId","data-v-31aab8a0"]]);export{_e as default};
